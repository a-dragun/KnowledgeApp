<h1 class="user-profile-title"><%= @user.name %></h1>

<div class="user-info">
  <p>Email: <%= @user.email %></p>
  <p>Role: <%= @user.role.humanize %></p>
  <p>Faculty: <%= @user.faculty&.name || 'N/A' %></p>
  <p>Documents: <%= @document_count %></p>
</div>

<% if @documents.present? %>
  <h2 class="section-title">Documents Created by <%= @user.name %></h2>
  <div class="table-container">
    <table class="user-table">
      <thead>
        <tr>
          <th>Title</th>
          <th>Faculty</th>
          <th>Path</th>
          <th>Created At</th>
        </tr>
      </thead>
      <tbody>
        <% @documents.each do |document| %>
          <tr>
            <td><%= link_to document.title, document_path(document) %></td>
            <td><%= link_to document.faculty.name, faculty_path(document.faculty) %></td>
            <td>
              <% path = []
              current_folder = document.folder
              while current_folder
                path.unshift(current_folder.name)
                current_folder = current_folder.parent_folder
              end
              path.push(document.title + '.md') %>
              <%= path.join('/') %>
            </td>
            <td><%= document.created_at.strftime("%B %d, %Y %H:%M:%S") %></td>
          </tr>
        <% end %>
      </tbody>
    </table>
  </div>
<% else %>
  <p class="no-results">No documents found.</p>
<% end %>

<div class="user-actions">
  <% if current_user.admin? %>
    <% if current_user != @user %>
      <%= link_to 'Edit Profile', edit_user_path(@user), class: 'btn-primary' %>
      <%= button_to 'Delete Account', user_path(@user), method: :delete, data: { confirm: 'Are you sure you want to delete this account? This action cannot be undone.' }, class: 'btn btn-danger' %>
    <% end %>
  <% else %>
    <% if current_user == @user %>
      <%= link_to 'Edit Profile', edit_user_path(@user), class: 'btn-primary' %>
    <% end %>
  <% end %>
</div>
